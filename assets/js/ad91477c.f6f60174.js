(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6804],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return l},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},l=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||s;return n?r.createElement(h,i(i({ref:t},l),{},{components:n})):r.createElement(h,i({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,i=new Array(s);i[0]=d;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var c=2;c<s;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},4841:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c},default:function(){return u}});var r=n(2122),a=n(9756),s=(n(7294),n(3905)),i=["components"],o={sidebar_position:3},p={unversionedId:"cw-plus/cw4/cw4-stake-spec",id:"cw-plus/cw4/cw4-stake-spec",isDocsHomePage:!1,title:"CW4 Stake",description:"cw4-stake source code//github.com/CosmWasm/cosmwasm-plus/tree/master/contracts/cw4-stake",source:"@site/docs/cw-plus/cw4/cw4-stake-spec.md",sourceDirName:"cw-plus/cw4",slug:"/cw-plus/cw4/cw4-stake-spec",permalink:"/0.14/cw-plus/cw4/cw4-stake-spec",editUrl:"https://github.com/CosmWasm/docs/edit/master/docs/cw-plus/cw4/cw4-stake-spec.md",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"CW4 Group",permalink:"/0.14/cw-plus/cw4/cw4-group-spec"},next:{title:"CW20 Spec: Fungible Tokens",permalink:"/0.14/cw-plus/cw20/spec"}},c=[{value:"Init",id:"init",children:[]},{value:"Messages",id:"messages",children:[]}],l={toc:c};function u(e){var t=e.components,n=(0,a.Z)(e,i);return(0,s.kt)("wrapper",(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"cw4-stake source code: ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/CosmWasm/cosmwasm-plus/tree/master/contracts/cw4-stake"},"https://github.com/CosmWasm/cosmwasm-plus/tree/master/contracts/cw4-stake")),(0,s.kt)("p",null,"This is a second implementation of the ",(0,s.kt)("a",{parentName:"p",href:"/0.14/cw-plus/cw4/spec"},"cw4 spec"),".\nIt fulfills all elements of the spec, including the raw query lookups,\nand is designed to be used as a backing storage for\n",(0,s.kt)("a",{parentName:"p",href:"/0.14/cw-plus/cw3/spec"},"cw3 compliant contracts"),"."),(0,s.kt)("p",null,"It provides a similar API to ","[",(0,s.kt)("inlineCode",{parentName:"p"},"cw4-group"),"]"," (which handles elected membership),\nbut rather than appointing members (by admin or multisig), their\nmembership and weight are based on the number of tokens they have staked.\nThis is similar to many DAOs."),(0,s.kt)("p",null,"Only one denom can be bonded with both ",(0,s.kt)("inlineCode",{parentName:"p"},"min_bond")," as the minimum amount\nthat must be sent by one address to enter, as well as ",(0,s.kt)("inlineCode",{parentName:"p"},"tokens_per_weight"),",\nwhich can be used to normalize the weight (eg. if the token is uatom\nand you want 1 weight per ATOM, you can set ",(0,s.kt)("inlineCode",{parentName:"p"},"tokens_per_weight = 1_000_000"),")."),(0,s.kt)("p",null,"There is also an unbonding period (",(0,s.kt)("inlineCode",{parentName:"p"},"Duration"),') which sets how long the\ntokens are frozen before being released. These frozen tokens can neither\nbe used for voting, nor claimed by the original owner. Only after the period\ncan you get your tokens back. This liquidity loss is the "skin in the game"\nprovided by staking to this contract.'),(0,s.kt)("h2",{id:"init"},"Init"),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"TODO")),(0,s.kt)("p",null,"To create it, you must pass in a list of members, as well as an optional\n",(0,s.kt)("inlineCode",{parentName:"p"},"admin"),", if you wish it to be mutable."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-rust"},"pub struct InitMsg {\n    /// denom of the token to stake\n    pub stake: String,\n    pub tokens_per_weight: u64,\n    pub min_bond: Uint128,\n    pub unbonding_period: Duration,\n}\n")),(0,s.kt)("p",null,"Members are defined by an address and a weight. This is transformed\nand stored under their ",(0,s.kt)("inlineCode",{parentName:"p"},"CanonicalAddr"),", in a format defined in\n",(0,s.kt)("a",{parentName:"p",href:"/0.14/cw-plus/cw4/spec#raw"},"cw4 raw queries"),"."),(0,s.kt)("p",null,"Note that 0 ",(0,s.kt)("em",{parentName:"p"},"is an allowed weight"),". This doesn't give any voting rights,\nbut it does define this address is part of the group, which may be\nmeaningful in some circumstances."),(0,s.kt)("p",null,"The weights of the members will be computed as the funds they send\n(in tokens) divided by ",(0,s.kt)("inlineCode",{parentName:"p"},"tokens_per_weight"),", rounded down to the nearest\nwhole number (i.e. using integer division). If the total sent is less than\n",(0,s.kt)("inlineCode",{parentName:"p"},"min_bond"),", the stake will remain, but they will not be counted as a\nmember. If ",(0,s.kt)("inlineCode",{parentName:"p"},"min_bond")," is higher than ",(0,s.kt)("inlineCode",{parentName:"p"},"tokens_per_weight"),", you cannot\nhave any member with 0 weight."),(0,s.kt)("h2",{id:"messages"},"Messages"),(0,s.kt)("p",null,"Most messages and queries are defined by the\n",(0,s.kt)("a",{parentName:"p",href:"/0.14/cw-plus/cw4/spec"},"cw4 spec"),". Please refer to it for more info."),(0,s.kt)("p",null,"The following messages have been added to handle un/staking tokens:"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Bond{}")," - bond all staking tokens sent with the message and update membership weight"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Unbond{tokens}")," - starts the unbonding process for the given number\nof tokens. The sender immediately loses weight from these tokens,\nand can claim them back to his wallet after ",(0,s.kt)("inlineCode",{parentName:"p"},"unbonding_period")),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Claim{}"),' -  used to claim your native tokens that you previously "unbonded"\nafter the contract-defined waiting period (eg. 1 week)'),(0,s.kt)("p",null,"And the corresponding queries:"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Claims{address}")," - Claims shows the tokens in process of unbonding\nfor this address"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"Staked{address}")," - Show the number of tokens currently staked by this address."))}u.isMDXComponent=!0}}]);